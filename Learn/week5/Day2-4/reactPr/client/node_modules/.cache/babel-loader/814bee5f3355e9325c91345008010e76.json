{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/he125/OneDrive/\\uBC14\\uD0D5 \\uD654\\uBA74/Dev/Git/Aihub_webTrack/Learn/week5/Day2-4/reactPr/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/he125/OneDrive/\\uBC14\\uD0D5 \\uD654\\uBA74/Dev/Git/Aihub_webTrack/Learn/week5/Day2-4/reactPr/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/he125/OneDrive/\\uBC14\\uD0D5 \\uD654\\uBA74/Dev/Git/Aihub_webTrack/Learn/week5/Day2-4/reactPr/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useEffect}from\"react\";import url from\"../../data/port.json\";// import { User } from \"../../../../server/models\";\nimport{useNavigate}from\"react-router-dom\";import{useCookies}from\"react-cookie\";// 카카오소셜연동.(2)\nvar KakaoCallBack=function KakaoCallBack(){var navigate=useNavigate();var _useCookies=useCookies([\"auth\"]),_useCookies2=_slicedToArray(_useCookies,3),cookiesAuth=_useCookies2[0],setCookieAuth=_useCookies2[1],removeCookieAuth=_useCookies2[2];var _useCookies3=useCookies([\"userData\"]),_useCookies4=_slicedToArray(_useCookies3,3),cookies=_useCookies4[0],setCookie=_useCookies4[1],removeCookie=_useCookies4[2];//kakao에서 redirect 해준 code 가져오는 부분\nvar KAKAO_PARAMS=new URL(window.location.href).searchParams.get(\"code\");useEffect(function(){console.log(KAKAO_PARAMS);sendCode().then(function(res){console.log(res.data);if(res.data.login){// true면 로그인 돼있는 상태\nsetCookie(\"userData\",res.data,{path:\"/\"});navigate(\"/review/list\");}else{// false면 회원가입 진행해야하는 상태\nsetCookie(\"auth\",res.data,{path:\"/\"});navigate(\"/oauth/signUp\");}}).catch(function(e){console.log(e);navigate(\"/\");});},[]);// deps=[]는 최초 렌더링 시에만 동작하도록 설정\n// 카카오소셜연동.(3) : 해당 로컬 서버가 -> 카카오 서버에 요청\nvar sendCode=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(url.url+\"/auth/kakao\",{params:{code:KAKAO_PARAMS}});case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);}));return function sendCode(){return _ref.apply(this,arguments);};}();};export default KakaoCallBack;","map":{"version":3,"names":["axios","useEffect","url","useNavigate","useCookies","KakaoCallBack","navigate","cookiesAuth","setCookieAuth","removeCookieAuth","cookies","setCookie","removeCookie","KAKAO_PARAMS","URL","window","location","href","searchParams","get","console","log","sendCode","then","res","data","login","path","catch","e","params","code"],"sources":["C:/Users/he125/OneDrive/바탕 화면/Dev/Git/Aihub_webTrack/Learn/week5/Day2-4/reactPr/client/src/pages/kakao/kakaoCallback.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useEffect } from \"react\";\r\nimport url from \"../../data/port.json\";\r\n// import { User } from \"../../../../server/models\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useCookies } from \"react-cookie\";\r\n\r\n// 카카오소셜연동.(2)\r\nconst KakaoCallBack = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const [cookiesAuth, setCookieAuth, removeCookieAuth] = useCookies([\"auth\"]);\r\n  const [cookies, setCookie, removeCookie] = useCookies([\"userData\"]);\r\n\r\n  //kakao에서 redirect 해준 code 가져오는 부분\r\n  const KAKAO_PARAMS = new URL(window.location.href).searchParams.get(\"code\");\r\n\r\n\r\n  useEffect(() => {\r\n    console.log(KAKAO_PARAMS);\r\n\r\n    sendCode()\r\n      .then((res) => {\r\n        console.log(res.data);\r\n\r\n        if (res.data.login) {\r\n          // true면 로그인 돼있는 상태\r\n\r\n          setCookie(\"userData\", res.data, { path: \"/\" });\r\n          navigate(\"/review/list\");\r\n        } else {\r\n          // false면 회원가입 진행해야하는 상태\r\n          setCookie(\"auth\", res.data, { path: \"/\" });\r\n          navigate(\"/oauth/signUp\");\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        console.log(e);\r\n        navigate(\"/\");\r\n      });\r\n  }, []); // deps=[]는 최초 렌더링 시에만 동작하도록 설정\r\n\r\n  // 카카오소셜연동.(3) : 해당 로컬 서버가 -> 카카오 서버에 요청\r\n  const sendCode = async () => {\r\n    return await axios.get(url.url + `/auth/kakao`, {\r\n      params: {\r\n        code: KAKAO_PARAMS,\r\n      },\r\n    });\r\n  };\r\n};\r\n\r\nexport default KakaoCallBack;\r\n"],"mappings":"glBAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,KAA0B,OAA1B,CACA,MAAOC,IAAP,KAAgB,sBAAhB,CACA;AACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,UAAT,KAA2B,cAA3B,CAEA;AACA,GAAMC,cAAa,CAAG,QAAhBA,cAAgB,EAAM,CAC1B,GAAMC,SAAQ,CAAGH,WAAW,EAA5B,CAEA,gBAAuDC,UAAU,CAAC,CAAC,MAAD,CAAD,CAAjE,4CAAOG,WAAP,iBAAoBC,aAApB,iBAAmCC,gBAAnC,iBACA,iBAA2CL,UAAU,CAAC,CAAC,UAAD,CAAD,CAArD,6CAAOM,OAAP,iBAAgBC,SAAhB,iBAA2BC,YAA3B,iBAEA;AACA,GAAMC,aAAY,CAAG,GAAIC,IAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,IAAxB,EAA8BC,YAA9B,CAA2CC,GAA3C,CAA+C,MAA/C,CAArB,CAGAlB,SAAS,CAAC,UAAM,CACdmB,OAAO,CAACC,GAAR,CAAYR,YAAZ,EAEAS,QAAQ,GACLC,IADH,CACQ,SAACC,GAAD,CAAS,CACbJ,OAAO,CAACC,GAAR,CAAYG,GAAG,CAACC,IAAhB,EAEA,GAAID,GAAG,CAACC,IAAJ,CAASC,KAAb,CAAoB,CAClB;AAEAf,SAAS,CAAC,UAAD,CAAaa,GAAG,CAACC,IAAjB,CAAuB,CAAEE,IAAI,CAAE,GAAR,CAAvB,CAAT,CACArB,QAAQ,CAAC,cAAD,CAAR,CACD,CALD,IAKO,CACL;AACAK,SAAS,CAAC,MAAD,CAASa,GAAG,CAACC,IAAb,CAAmB,CAAEE,IAAI,CAAE,GAAR,CAAnB,CAAT,CACArB,QAAQ,CAAC,eAAD,CAAR,CACD,CACF,CAdH,EAeGsB,KAfH,CAeS,SAACC,CAAD,CAAO,CACZT,OAAO,CAACC,GAAR,CAAYQ,CAAZ,EACAvB,QAAQ,CAAC,GAAD,CAAR,CACD,CAlBH,EAmBD,CAtBQ,CAsBN,EAtBM,CAAT,CAsBQ;AAER;AACA,GAAMgB,SAAQ,4FAAG,2JACFtB,MAAK,CAACmB,GAAN,CAAUjB,GAAG,CAACA,GAAJ,cAAV,CAAmC,CAC9C4B,MAAM,CAAE,CACNC,IAAI,CAAElB,YADA,CADsC,CAAnC,CADE,6GAAH,kBAARS,SAAQ,0CAAd,CAOD,CA1CD,CA4CA,cAAejB,cAAf"},"metadata":{},"sourceType":"module"}