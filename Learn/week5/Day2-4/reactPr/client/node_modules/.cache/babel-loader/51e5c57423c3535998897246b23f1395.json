{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport { useEffect } from \"react\";\nimport url from \"../../data/port.json\"; // import { User } from \"../../../../server/models\";\n\nimport { useNavigate } from \"react-router-dom\";\nimport { useCookies } from \"react-cookie\"; // 카카오소셜연동.(2)\n\nconst KakaoCallBack = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const [cookiesAuth, setCookieAuth, removeCookieAuth] = useCookies([\"auth\"]);\n  const [cookies, setCookie, removeCookie] = useCookies([\"userData\"]); //kakao에서 redirect 해준 code 가져오는 부분\n\n  const KAKAO_PARAMS = new URL(window.location.href).searchParams.get(\"code\");\n  useEffect(() => {\n    console.log(KAKAO_PARAMS);\n    sendCode().then(res => {\n      console.log(res.data);\n\n      if (res.data.login) {\n        // true면 로그인 돼있는 상태\n        setCookie(\"userData\", res.data, {\n          path: \"/\"\n        });\n        navigate(\"/review/list\");\n      } else {\n        // false면 회원가입 진행해야하는 상태\n        setCookie(\"auth\", res.data, {\n          path: \"/\"\n        });\n        navigate(\"/oauth/signUp\");\n      }\n    }).catch(e => {\n      console.log(e);\n      navigate(\"/\");\n    });\n  }, []); // deps=[]는 최초 렌더링 시에만 동작하도록 설정\n  // 카카오소셜연동.(3) : 해당 로컬 서버가 -> 카카오 서버에 요청\n\n  const sendCode = async () => {\n    return await axios.get(url.url + `/auth/kakao`, {\n      params: {\n        code: KAKAO_PARAMS\n      }\n    });\n  };\n};\n\n_s(KakaoCallBack, \"KKMb9XKlXW5J+nuo6i/d/XCUcAo=\", false, function () {\n  return [useNavigate, useCookies, useCookies];\n});\n\n_c = KakaoCallBack;\nexport default KakaoCallBack;\n\nvar _c;\n\n$RefreshReg$(_c, \"KakaoCallBack\");","map":{"version":3,"names":["axios","useEffect","url","useNavigate","useCookies","KakaoCallBack","navigate","cookiesAuth","setCookieAuth","removeCookieAuth","cookies","setCookie","removeCookie","KAKAO_PARAMS","URL","window","location","href","searchParams","get","console","log","sendCode","then","res","data","login","path","catch","e","params","code"],"sources":["C:/Users/he125/OneDrive/바탕 화면/Dev/Git/Aihub_webTrack/Learn/week5/Day2-3/reactPr/client/src/pages/kakao/kakaoCallback.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useEffect } from \"react\";\r\nimport url from \"../../data/port.json\";\r\n// import { User } from \"../../../../server/models\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useCookies } from \"react-cookie\";\r\n\r\n// 카카오소셜연동.(2)\r\nconst KakaoCallBack = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const [cookiesAuth, setCookieAuth, removeCookieAuth] = useCookies([\"auth\"]);\r\n  const [cookies, setCookie, removeCookie] = useCookies([\"userData\"]);\r\n\r\n  //kakao에서 redirect 해준 code 가져오는 부분\r\n  const KAKAO_PARAMS = new URL(window.location.href).searchParams.get(\"code\");\r\n\r\n\r\n  useEffect(() => {\r\n    console.log(KAKAO_PARAMS);\r\n\r\n    sendCode()\r\n      .then((res) => {\r\n        console.log(res.data);\r\n\r\n        if (res.data.login) {\r\n          // true면 로그인 돼있는 상태\r\n\r\n          setCookie(\"userData\", res.data, { path: \"/\" });\r\n          navigate(\"/review/list\");\r\n        } else {\r\n          // false면 회원가입 진행해야하는 상태\r\n          setCookie(\"auth\", res.data, { path: \"/\" });\r\n          navigate(\"/oauth/signUp\");\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        console.log(e);\r\n        navigate(\"/\");\r\n      });\r\n  }, []); // deps=[]는 최초 렌더링 시에만 동작하도록 설정\r\n\r\n  // 카카오소셜연동.(3) : 해당 로컬 서버가 -> 카카오 서버에 요청\r\n  const sendCode = async () => {\r\n    return await axios.get(url.url + `/auth/kakao`, {\r\n      params: {\r\n        code: KAKAO_PARAMS,\r\n      },\r\n    });\r\n  };\r\n};\r\n\r\nexport default KakaoCallBack;\r\n"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,OAAOC,GAAP,MAAgB,sBAAhB,C,CACA;;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,UAAT,QAA2B,cAA3B,C,CAEA;;AACA,MAAMC,aAAa,GAAG,MAAM;EAAA;;EAC1B,MAAMC,QAAQ,GAAGH,WAAW,EAA5B;EAEA,MAAM,CAACI,WAAD,EAAcC,aAAd,EAA6BC,gBAA7B,IAAiDL,UAAU,CAAC,CAAC,MAAD,CAAD,CAAjE;EACA,MAAM,CAACM,OAAD,EAAUC,SAAV,EAAqBC,YAArB,IAAqCR,UAAU,CAAC,CAAC,UAAD,CAAD,CAArD,CAJ0B,CAM1B;;EACA,MAAMS,YAAY,GAAG,IAAIC,GAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,IAAxB,EAA8BC,YAA9B,CAA2CC,GAA3C,CAA+C,MAA/C,CAArB;EAGAlB,SAAS,CAAC,MAAM;IACdmB,OAAO,CAACC,GAAR,CAAYR,YAAZ;IAEAS,QAAQ,GACLC,IADH,CACSC,GAAD,IAAS;MACbJ,OAAO,CAACC,GAAR,CAAYG,GAAG,CAACC,IAAhB;;MAEA,IAAID,GAAG,CAACC,IAAJ,CAASC,KAAb,EAAoB;QAClB;QAEAf,SAAS,CAAC,UAAD,EAAaa,GAAG,CAACC,IAAjB,EAAuB;UAAEE,IAAI,EAAE;QAAR,CAAvB,CAAT;QACArB,QAAQ,CAAC,cAAD,CAAR;MACD,CALD,MAKO;QACL;QACAK,SAAS,CAAC,MAAD,EAASa,GAAG,CAACC,IAAb,EAAmB;UAAEE,IAAI,EAAE;QAAR,CAAnB,CAAT;QACArB,QAAQ,CAAC,eAAD,CAAR;MACD;IACF,CAdH,EAeGsB,KAfH,CAeUC,CAAD,IAAO;MACZT,OAAO,CAACC,GAAR,CAAYQ,CAAZ;MACAvB,QAAQ,CAAC,GAAD,CAAR;IACD,CAlBH;EAmBD,CAtBQ,EAsBN,EAtBM,CAAT,CAV0B,CAgClB;EAER;;EACA,MAAMgB,QAAQ,GAAG,YAAY;IAC3B,OAAO,MAAMtB,KAAK,CAACmB,GAAN,CAAUjB,GAAG,CAACA,GAAJ,GAAW,aAArB,EAAmC;MAC9C4B,MAAM,EAAE;QACNC,IAAI,EAAElB;MADA;IADsC,CAAnC,CAAb;EAKD,CAND;AAOD,CA1CD;;GAAMR,a;UACaF,W,EAEsCC,U,EACZA,U;;;KAJvCC,a;AA4CN,eAAeA,aAAf"},"metadata":{},"sourceType":"module"}